#!/bin/bash
#
# Here we flesh out the gitsubmodules, if they haven't
# already been done.
# If this is in build.sh, then these updates occur only
# inside the container, and don't add to the FS, but 
# locally this will add all of the submodule files to
# the vendor path.
#

echo "  --> retrieving vendor dependencies [recursively]"

# @TODO can we automate this list from .gitmodules?
#(
#	git submodule foreach `echo "     - ${name}"; git submodule update --force --init --recursive ${name}`
#)

DEPS="github.com/Sirupsen/logrus
gopkg.in/urfave/cli.v2
github.com/wunderkraut/radi-api
github.com/wunderkraut/radi-handlers
github.com/wunderkraut/radi-handler-upcloud
github.com/wunderkraut/radi-handler-rancher"

for DEP in $DEPS; do
	echo "     - ${DEP}"

	(
		git submodule update --force --init --recursive "vendor/${DEP}"
	)
done

echo "  --- Finished dependency update"